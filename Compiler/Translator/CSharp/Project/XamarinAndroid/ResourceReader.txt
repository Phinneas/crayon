using System.Collections.Generic;

namespace %%%PROJECT_ID%%%
{
	internal static class ResourceReader
	{
		public static Android.Content.Res.AssetManager Assets { get; set; }

        private static readonly byte[] BUFFER = new byte[1000];

		private static byte[] ReadAsset(string pathInAssetsFolder)
		{
			System.IO.Stream stream = Assets.Open(pathInAssetsFolder);

            List<byte> resource = new List<byte>();

            int bytesRead;
            while (true)
            {
                bytesRead = stream.Read(BUFFER, 0, BUFFER.Length);
                if (bytesRead > 0)
                {
                    if (bytesRead == BUFFER.Length)
                    {
                        resource.AddRange(BUFFER);
                    }
                    else
                    {
                        for (int i = 0; i < bytesRead; ++i)
                        {
                            resource.Add(BUFFER[i]);
                        }
                    }
                }
                else
                {
                    break;
                }
            }
            
			return resource.ToArray();
		}

        public static string ReadTextResource(string path)
        {
            byte[] bytes = ReadAsset(path);
            return System.Text.UTF8Encoding.UTF8.GetString(bytes);
        }

		public static string ReadByteCodeFile()
		{
			return ReadTextResource("ByteCode.txt");
		}

		public static Android.Graphics.Bitmap ReadImageFile(string path, bool generatedImage)
		{
            byte[] imageFileBytes = ReadAsset(path);
            return Android.Graphics.BitmapFactory.DecodeByteArray(imageFileBytes, 0, imageFileBytes.Length);
		}
	}
}
